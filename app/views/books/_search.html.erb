<%= form_with(url: books_path, method: :get, data: {controller: "search", turbo_frame: "books", turbo_action: "advance"}) do |form| %>
  <div class="search" data-turbo>
    <div>
      <%= form.text_field :title, placeholder: "Search", class: "search__bar", data: {action: "input->search#search"} %>
      <%= form.submit 'Search', name: nil %>
      <% if @books.present? %>
        <div data-controller="books">
        <%= form.fields_for :books do |builder| %>
          <%= render(:partial => 'books', locals: {form: builder, books: @books.map { |book| ["#{book.title} - #{book.author}", book.isbn] }}) %>
        <% end %>
      </div>
    <% end %>
    </div>
  </div>
<% end %>